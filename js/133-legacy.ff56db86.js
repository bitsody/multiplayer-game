(self["webpackChunkgeoguess"]=self["webpackChunkgeoguess"]||[]).push([[133],{16295:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(25469);function n(e){return Array.isArray(e)?m(e):e&&e.bbox?m(e.bbox):[c(),d()]}function o(e,t){void 0===t&&(t={}),void 0!==e&&null!==e||(e=1);for(var r=[],o=0;o<e;o++)r.push(i.point(n(t.bbox)));return i.featureCollection(r)}function a(e,t){void 0===t&&(t={}),void 0!==e&&null!==e||(e=1),i.isNumber(t.num_vertices)&&void 0!==t.num_vertices||(t.num_vertices=10),i.isNumber(t.max_radial_length)&&void 0!==t.max_radial_length||(t.max_radial_length=10);for(var r=[],o=function(e){var o=[],a=Array.apply(null,new Array(t.num_vertices+1)).map(Math.random);a.forEach((function(e,t,r){r[t]=t>0?e+r[t-1]:e})),a.forEach((function(e){e=2*e*Math.PI/a[a.length-1];var r=Math.random();o.push([r*(t.max_radial_length||10)*Math.sin(e),r*(t.max_radial_length||10)*Math.cos(e)])})),o[o.length-1]=o[0],o=o.map(l(n(t.bbox))),r.push(i.polygon([o]))},a=0;a<e;a++)o(a);return i.featureCollection(r)}function s(e,t){if(void 0===t&&(t={}),t=t||{},!i.isObject(t))throw new Error("options is invalid");var r=t.bbox,o=t.num_vertices,a=t.max_length,s=t.max_rotation;void 0!==e&&null!==e||(e=1),(!i.isNumber(o)||void 0===o||o<2)&&(o=10),i.isNumber(a)&&void 0!==a||(a=1e-4),i.isNumber(s)&&void 0!==s||(s=Math.PI/8);for(var l=[],u=0;u<e;u++){for(var c=n(r),d=[c],m=0;m<o-1;m++){var h=0===m?2*Math.random()*Math.PI:Math.tan((d[m][1]-d[m-1][1])/(d[m][0]-d[m-1][0])),p=h+(Math.random()-.5)*s*2,f=Math.random()*a;d.push([d[m][0]+f*Math.cos(p),d[m][1]+f*Math.sin(p)])}l.push(i.lineString(d))}return i.featureCollection(l)}function l(e){return function(t){return[t[0]+e[0],t[1]+e[1]]}}function u(){return Math.random()-.5}function c(){return 360*u()}function d(){return 180*u()}function m(e){return[Math.random()*(e[2]-e[0])+e[0],Math.random()*(e[3]-e[1])+e[1]]}t.randomPosition=n,t.randomPoint=o,t.randomPolygon=a,t.randomLineString=s},25469:function(e,t){"use strict";function r(e,t,r){void 0===r&&(r={});var i={type:"Feature"};return(0===r.id||r.id)&&(i.id=r.id),r.bbox&&(i.bbox=r.bbox),i.properties=t||{},i.geometry=e,i}function i(e,t,r){switch(void 0===r&&(r={}),e){case"Point":return n(t).geometry;case"LineString":return l(t).geometry;case"Polygon":return a(t).geometry;case"MultiPoint":return m(t).geometry;case"MultiLineString":return d(t).geometry;case"MultiPolygon":return h(t).geometry;default:throw new Error(e+" is invalid")}}function n(e,t,i){if(void 0===i&&(i={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!P(e[0])||!P(e[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:e};return r(n,t,i)}function o(e,t,r){return void 0===r&&(r={}),c(e.map((function(e){return n(e,t)})),r)}function a(e,t,i){void 0===i&&(i={});for(var n=0,o=e;n<o.length;n++){var a=o[n];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}var l={type:"Polygon",coordinates:e};return r(l,t,i)}function s(e,t,r){return void 0===r&&(r={}),c(e.map((function(e){return a(e,t)})),r)}function l(e,t,i){if(void 0===i&&(i={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:e};return r(n,t,i)}function u(e,t,r){return void 0===r&&(r={}),c(e.map((function(e){return l(e,t)})),r)}function c(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function d(e,t,i){void 0===i&&(i={});var n={type:"MultiLineString",coordinates:e};return r(n,t,i)}function m(e,t,i){void 0===i&&(i={});var n={type:"MultiPoint",coordinates:e};return r(n,t,i)}function h(e,t,i){void 0===i&&(i={});var n={type:"MultiPolygon",coordinates:e};return r(n,t,i)}function p(e,t,i){void 0===i&&(i={});var n={type:"GeometryCollection",geometries:e};return r(n,t,i)}function f(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r}function g(e,r){void 0===r&&(r="kilometers");var i=t.factors[r];if(!i)throw new Error(r+" units is invalid");return e*i}function y(e,r){void 0===r&&(r="kilometers");var i=t.factors[r];if(!i)throw new Error(r+" units is invalid");return e/i}function v(e,t){return w(y(e,t))}function b(e){var t=e%360;return t<0&&(t+=360),t}function w(e){var t=e%(2*Math.PI);return 180*t/Math.PI}function S(e){var t=e%360;return t*Math.PI/180}function x(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return g(y(e,t),r)}function k(e,r,i){if(void 0===r&&(r="meters"),void 0===i&&(i="kilometers"),!(e>=0))throw new Error("area must be a positive number");var n=t.areaFactors[r];if(!n)throw new Error("invalid original units");var o=t.areaFactors[i];if(!o)throw new Error("invalid final units");return e/n*o}function P(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function M(e){return!!e&&e.constructor===Object}function _(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!P(e))throw new Error("bbox must only contain numbers")}))}function L(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:1.0936*t.earthRadius},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1.0936133},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=r,t.geometry=i,t.point=n,t.points=o,t.polygon=a,t.polygons=s,t.lineString=l,t.lineStrings=u,t.featureCollection=c,t.multiLineString=d,t.multiPoint=m,t.multiPolygon=h,t.geometryCollection=p,t.round=f,t.radiansToLength=g,t.lengthToRadians=y,t.lengthToDegrees=v,t.bearingToAzimuth=b,t.radiansToDegrees=w,t.degreesToRadians=S,t.convertLength=x,t.convertArea=k,t.isNumber=P,t.isObject=M,t.validateBBox=_,t.validateId=L},77133:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return qe}});var i=r(40641),n=r(96612),o=r(3877),a=r(13568),s=r(1742),l=r(18184),u=r(97622),c=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"game-page"}},[t("div",{attrs:{id:"street-view-container"}},[t("HeaderGame",{ref:"header",attrs:{distance:e.scoreHeader,points:e.pointsHeader,round:e.round,"room-name":e.roomName,"nb-round":e.nbRound,"remaining-time":e.remainingTime,mode:e.mode,leaderboardEnabled:e.guessedLeaderboard||e.scoreLeaderboard},on:{toggleLeaderboard:function(t){e.leaderboardShown=!e.leaderboardShown}}}),t("div",{attrs:{id:"game-interface"}},[t(a.Z,{attrs:{value:!e.isReady&&!e.multiplayer,opacity:"0.5"}},[t(s.Z,{attrs:{indeterminate:"",size:"64"}})],1),t("div",{ref:"streetView",attrs:{id:"street-view"}}),t("div",{attrs:{id:"game-interface__overlay"}},[t(u.Z,{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(r){var i=r.on,a=r.attrs;return[t(n.Z,e._g(e._b({staticClass:"resetBtn",attrs:{rounded:"",dark:"",fab:""},on:{click:e.resetLocation}},"v-btn",a,!1),i),[t(o.Z,[e._v("mdi-crosshairs-gps")])],1)]}}])},[t("span",[e._v(e._s(e.$t("Maps.reset")))])]),t("Maps",{ref:"mapContainer",attrs:{"random-lat-lng":e.randomLatLng,"random-feature-properties":e.randomFeatureProperties,"room-name":e.roomName,"player-number":e.playerNumber,"player-name":e.playerName,"is-ready":!!e.randomLatLng,round:e.round,score:e.score,points:e.points,difficulty:e.difficultyData,"time-limitation":e.timeLimitation,bbox:e.bbox,mode:e.mode,area:e.area,"time-attack":e.timeAttack,"nb-round":e.nbRound,countdown:e.countdown,"score-mode":e.scoreMode,areasGeoJsonUrl:e.areaParams&&e.areaParams.data.urlArea,pathKey:e.areaParams?e.areaParams.data.pathKey:"iso_a2",mapDetails:e.mapDetails},on:{resetLocation:e.resetLocation,calculateDistance:e.updateScore,showResult:e.showResult,goToNextRound:e.goToNextRound,finishGame:e.finishGame,printMapFull:function(t){e.printMapFull=t}}})],1)],1)],1),t(a.Z,{attrs:{value:e.overlay,opacity:"0.8","z-index":"1"}}),t("DialogMessage",{attrs:{"dialog-message":e.dialogMessage,"dialog-title":e.dialogTitle,"dialog-text":e.dialogText}}),t("div",{staticClass:"alert-container"},[e.$vuetify.breakpoint.mobile||!e.roomName||e.printMapFull?e._e():t("Leaderboard",{attrs:{leaderboard:e.leaderboard},model:{value:e.leaderboardShown,callback:function(t){e.leaderboardShown=t},expression:"leaderboardShown"}}),e.$vuetify.breakpoint.mobile&&e.roomName&&!e.printMapFull?t("DialogMessage",{attrs:{"dialog-title":"Leaderboard",dismissible:!0,dialogMessage:e.leaderboardShown},on:{close:function(t){e.leaderboardShown=!1}}},[t("LeaderboardContent",{attrs:{leaderboard:e.leaderboard}})],1):e._e(),e.isVisibleDialog?t(i.Z,{staticClass:"warning-alert",attrs:{type:"warning",dismissible:""}},[t("b",[e._v(e._s(e.$t("StreetView.nearby.title")))]),e._v(" : "+e._s(e.$t("StreetView.nearby.message"))+" ")]):e._e(),t(i.Z,{attrs:{id:"warningCountdown",type:"info",dismissible:"",transition:"slide-x-transition",prominent:"",icon:"mdi-clock-fast"},model:{value:e.isVisibleCountdownAlert,callback:function(t){e.isVisibleCountdownAlert=t},expression:"isVisibleCountdownAlert"}},[e._v(" "+e._s(e.$tc("StreetView.countdownAlert",e.remainingTime))+" "),t(l.Z,{attrs:{active:e.isVisibleCountdownAlert,color:"white",absolute:"",bottom:""},model:{value:e.countdownPercentage,callback:function(t){e.countdownPercentage=t},expression:"countdownPercentage"}})],1)],1)],1)},d=[],m=r(45736),h=r(37819),p=r(60091),f=(r(9653),r(21249),r(69720),r(69826),r(41539),r(26699),r(32023),r(15503)),g=(r(14642),r(8420)),y=function(){var e=this,t=e._self._c;return t("div",[t(g.Z,{staticClass:"header-game",attrs:{color:"grey darken-4"}},[null!=e.remainingTime&&e.remainingTime>0?t("div",[t("span",{attrs:{id:"countdown-text"}},[e._v(e._s(e.countdownText))])]):t("div",[t("span",{attrs:{id:"countdown-text"}},[e._v(e._s(e.timerText))])]),e.roomName&&!e.streamerMode?t("div",{staticClass:"round-score-container room-name"},[t("span",{staticClass:"sub-text"},[e._v(e._s(e.$t("HeaderGame.room"))+" : ")]),t("span",{staticClass:"main-text"},[e._v(" "+e._s(e.roomName)+" ")])]):e._e(),t("div",{staticClass:"flex-grow-1"}),t("div",{staticClass:"round-score-container"},[t("span",{staticClass:"sub-text"},[e._v(e._s(e.$t("HeaderGame.round"))+": ")]),t("span",{staticClass:"main-text",attrs:{id:"roundLabel"}},[e._v(" "+e._s(e.round)+" / "+e._s(e.nbRound)+" ")])]),e.isDistanceVisible?t("div",{staticClass:"round-score-container"},[t("span",{staticClass:"sub-text"},[e._v(e._s(e.$t("HeaderGame.distance"))+": ")]),t("span",{staticClass:"main-text"},[e._v(e._s(e.$t("HeaderGame.kmaway",{value:new Intl.NumberFormat(e.$i18n.locale).format(e.distance/1e3)})))])]):e._e(),t("div",{staticClass:"round-points-container"},[t("span",{staticClass:"sub-text"},[e._v(e._s(e.$t("HeaderGame.score"))+": ")]),t("span",{staticClass:"main-text"},[e._v(e._s(e.points))])]),e.roomName&&e.leaderboardEnabled?t(u.Z,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(r){var i=r.on,a=r.attrs;return[t(n.Z,e._g(e._b({staticClass:"ml-3",attrs:{dark:"",elevation:"",fab:"",small:""},on:{click:e.toggleLeaderboard}},"v-btn",a,!1),i),[t(o.Z,[e._v("mdi-scoreboard-outline")])],1)]}}],null,!1,3135299119)},[t("span",[e._v(e._s(e.$t("StreetView.leaderboard")))])]):e._e()],1)],1)},v=[],b=r(63442),w=r(26008),S=r(20629),x={props:["distance","points","round","remainingTime","roomName","nbRound","mode","leaderboardEnabled"],data:function(){return{startedAt:null,timerText:"",intervalFunction:null}},watch:{round:function(){this.startTimer()}},computed:(0,p.Z)((0,p.Z)({},(0,S.rn)({streamerMode:function(e){return e.homeStore.streamerMode}})),{},{countdownText:function(){return(0,b.Xw)(this.remainingTime)},isDistanceVisible:function(){return this.mode!==w.wz.COUNTRY}}),methods:{startTimer:function(){var e=this;0==this.remainingTime&&(this.startedAt=new Date,this.intervalFunction=setInterval((function(){e.timerText=(0,b.Xw)(Math.round((Date.now()-e.startedAt)/1e3))}),1e3))},stopTimer:function(){this.intervalFunction&&clearInterval(this.intervalFunction)},toggleLeaderboard:function(){this.$emit("toggleLeaderboard")}}},k=x,P=r(1001),M=(0,P.Z)(k,y,v,!1,null,"3611ba70",null),_=M.exports,L=function(){var e=this,t=e._self._c;return t("div",e._g({class:[e.$viewport.width>=450&&(e.activeMap||e.pinActive)||e.isMakeGuessButtonClicked||e.isNextButtonVisible?"container-map--active":"",e.printMapFull?"container-map--full":"","container-map--size-".concat(e.size)],attrs:{id:"container-map"}},e.$viewport.width>=450?{mouseover:function(){e.activeMap=!0},mouseleave:function(){e.activeMap=!1}}:{}),[t("div",{staticClass:"container-map_details"},[t("div",{staticClass:"alert-container"},[e.guessString&&!e.$vuetify.breakpoint.mobile&&e.leaderboardShown?t("Leaderboard",{attrs:{"leaderboard-shown":e.leaderboardShown}}):e._e()],1),e.printMapFull?t("DetailsMap",{attrs:{properties:e.randomFeatureProperties}}):e._e()],1),t("div",{staticClass:"container-map_controls"},[t("div",{staticClass:"container-map_btns"},[t(n.Z,{attrs:{fab:"","x-small":""},on:{click:e.showNotepad}},[t(o.Z,{attrs:{dark:""}},[e._v(" mdi-file-document-edit ")])],1),t(n.Z,{attrs:{id:"btnDown",fab:"","x-small":"",disabled:e.size<2},on:{click:function(t){e.size--}}},[t(o.Z,{attrs:{dark:""}},[e._v(" mdi-arrow-bottom-left ")])],1),t(n.Z,{attrs:{id:"btnUp",fab:"","x-small":"",disabled:e.size>3},on:{click:function(t){e.size++}}},[t(o.Z,{attrs:{dark:""}},[e._v(" mdi-arrow-top-right ")])],1),t(n.Z,{attrs:{id:"btnPin",fab:"","x-small":""},on:{click:function(t){e.pinActive=!e.pinActive}}},[t(o.Z,{attrs:{dark:""}},[e._v(" mdi-pin"+e._s(e.pinActive?"-off":"")+" ")])],1)],1)]),e.$viewport.width<450&&!e.isGuessButtonClicked&&e.isMakeGuessButtonClicked?t(n.Z,{attrs:{id:"hide-map-button",fab:"","x-small":"",color:"red"},on:{click:e.hideMap}},[t(o.Z,{attrs:{color:"white"}},[e._v(" mdi-close ")])],1):e._e(),"classic"===this.mode?t("Map",{ref:"map",attrs:{id:"map",bbox:e.bbox},on:{setSeletedPos:e.setSeletedPos}}):e._e(),"classic"!==this.mode?t("MapAreas",{ref:"map",attrs:{id:"map",area:e.area,areasGeoJsonUrl:e.areasGeoJsonUrl,pathKey:e.pathKey,bbox:e.bbox,showFlag:"country"===this.mode},on:{setSeletedPos:e.setSeletedPos}}):e._e(),e.printMapFull?e._e():t("textarea",{directives:[{name:"show",rawName:"v-show",value:e.isNotepadVisible,expression:"isNotepadVisible"}],ref:"refNotepad",staticClass:"container-map_notepad",attrs:{spellcheck:"false"}}),e._v(" "),e.isNextButtonVisible||e.isSummaryButtonVisible||!(e.$viewport.width>450||e.isMakeGuessButtonClicked)?e._e():t("button",{attrs:{id:"guess-button",disabled:null==e.randomLatLng||null==e.selectedPos||e.isGuessButtonClicked||!!this.room&&!e.isReady},on:{click:e.selectLocation}},[e._v(" "+e._s(e.$t("Maps.guess"))+" ")]),e.isNextButtonVisible?t("button",{style:{backgroundColor:e.isNextButtonEnabled?"#F44336":"#B71C1C"},attrs:{id:"next-button",disabled:!e.isNextButtonEnabled},on:{click:function(t){return e.goToNextRound(!1)}}},[e._v(" "+e._s(e.$t("Maps.nextRound"))+" ")]):e._e(),e.isSummaryButtonVisible?t("button",{attrs:{id:"summary-button"},on:{click:function(t){e.dialogSummary=!0}}},[e._v(" "+e._s(e.$t("Maps.viewSummary"))+" ")]):e._e(),e.$viewport.width<450&&!e.isGuessButtonClicked&&!e.isMakeGuessButtonClicked&&!e.isNextButtonVisible?t("button",{staticClass:"primary",attrs:{id:"make-guess-button"},on:{click:e.showMap}},[e._v(" "+e._s(e.$t("Maps.makeGuess"))+" ")]):e._e(),t("DialogSummary",{attrs:{"dialog-summary":e.dialogSummary,"summary-texts":e.summaryTexts,score:e.score,"player-name":e.playerName,points:e.points,game:e.game,multiplayer:!!e.room,mapDetails:e.mapDetails,"nb-round":e.nbRound},on:{finishGame:e.finishGame,playAgain:function(t){return e.goToNextRound(!0)}}})],1)},C=[],N=(r(54747),r(83753),r(2707),r(23841)),R=r(15474),E=r(40441),Z=r(10033),T=function(){var e=this,t=e._self._c;return t(E.Z,{attrs:{value:e.dialogSummary,"max-width":"720",persistent:"",fullscreen:e.$viewport.width<450}},[t(N.Z,{attrs:{color:"#061422"}},[t(R.ZB,{attrs:{id:"card-text"}},[e.multiplayer?e._e():t(Z.Z,{attrs:{justify:"center"}},[t("p",{attrs:{id:"summary-text"},domProps:{innerHTML:e._s(e.$t("DialogSummary.summaryMsgSinglePoints",{points:e.points})+(e.showDistance?e.$t("DialogSummary.summaryMsgSingleDistance",{distance:e.score/1e3}):""))}})]),e._l(e.summaryTexts,(function(r,i){return t(Z.Z,{key:i,staticClass:"mt-3",attrs:{justify:"center"}},[t("span",{attrs:{id:"summary-text"}},[0==i||1==i||2==i?t(o.Z,{attrs:{color:0==i?"#CCAC00":1==i?"#C0C0C0":"#CC8E34"}},[e._v("mdi-crown")]):e._e(),t("span",{domProps:{innerHTML:e._s(e.$t("DialogSummary.summaryMsgMultiPoints",{playerName:r.playerName,points:r.finalPoints})+(e.showDistance?e.$t("DialogSummary.summaryMsgMultiDistance",{distance:r.finalScore/1e3}):""))}})],1)])})),t(Z.Z,{staticClass:"mt-8",attrs:{justify:"center"}},[t(n.Z,{staticClass:"mt-8",attrs:{id:"play-again-button",dark:"",color:"#43B581"},on:{click:function(t){return e.$emit("finishGame")}}},[e._v(" "+e._s(e.$t("DialogSummary.viewDetails"))+" ")]),e.multiplayer?e._e():t(n.Z,{staticClass:"mt-8",attrs:{id:"exit-button",dark:"",color:"#f44336"},on:{click:function(t){return e.$emit("playAgain")}}},[e._v(" "+e._s(e.$t("Maps.playAgain"))+" ")])],1)],2)],1)],1)},A=[],$=(r(34553),r(38862),{props:["dialogSummary","summaryTexts","playerName","score","points","multiplayer","game","mode","mapDetails","nbRound"],computed:{showDistance:function(){return this.mode===w.wz.CLASSIC}},watch:{dialogSummary:function(e){1==e&&this.updateRecord()}},methods:{updateRecord:function(){var e=this,t=localStorage.getItem("history");t=null==t?[]:JSON.parse(t),t.push((0,p.Z)((0,p.Z)({},this.game),{},{score:this.score,points:this.points,rank:this.multiplayer?this.summaryTexts.findIndex((function(t){return t.playerName===e.playerName}))+1:void 0,nbRound:this.nbRound,mapDetails:this.mapDetails})),localStorage.setItem("history",JSON.stringify(t))},finishGame:function(){this.$emit("finishGame")}}}),V=$,F=(0,P.Z)(V,T,A,!1,null,"200a3bd4",null),G=F.exports,O=r(1266),D=(r(82526),r(41817),r(29254),function(){var e=this,t=e._self._c;return e.properties&&"object"===(0,O.Z)(e.properties)&&(e.properties.title||e.properties.description)?t("div",{staticClass:"details-map_container"},[t("h2",[e._v(" "+e._s(e.properties.title)+" ")]),t("p",[e._v(" "+e._s(e.properties.description)+" ")]),e.properties.link&&e.validURL(e.properties.link)?t("a",{staticClass:"details-map_link",attrs:{href:e.properties.link,target:"_blank"}},[t(o.Z,{attrs:{color:"darkGreen"}},[e._v("mdi-alert-circle")]),e._v(" "+e._s(e.$t("DetailsMap.moreInfo")))],1):e._e()]):e._e()}),B=[],I={name:"DetailsMap",props:["properties"],methods:{validURL:function(e){return(0,b.b3)(e)}}},z=I,U=(0,P.Z)(z,D,B,!1,null,"4d0af0f4",null),j=U.exports,J=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"map"}},[t("GmapMap",{ref:"mapRef",attrs:{id:"mapClassic",center:{lat:37.86926,lng:-122.254811},zoom:1,"map-type-id":"roadmap",options:{fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1,draggableCursor:"crosshair",clickableIcons:!1,styles:e.$vuetify.theme.dark?e.$vuetify.theme.themes.dark.gmap:e.$vuetify.theme.themes.light.gmap}}})],1)},q=[],H=r(47312),K={props:["bbox"],watch:{bbox:function(){this.centerOnBbox()}},methods:{centerOnBbox:function(){this.map&&(this.bbox?this.map.fitBounds({east:this.bbox[2],north:this.bbox[3],south:Math.max(this.bbox[1],-89),west:this.bbox[0]}):(this.map.setZoom(0),this.map.setCenter({lat:0,lng:0})))},drawPolyline:function(){},removePolylines:function(){}}},W=K,Y={name:"Map",mixins:[W],data:function(){return{map:null,marker:[],markers:[],polylines:[],strokeColors:w.G8}},mounted:function(){var e=this;return(0,h.Z)((0,m.Z)().mark((function t(){return(0,m.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$gmapApiPromiseLazy();case 2:e.$refs.mapRef.$mapPromise.then((function(t){e.map=t,e.centerOnBbox()}));case 3:case"end":return t.stop()}}),t)})))()},methods:{putMarker:function(e,t,r){var i={};t&&(i={icon:{url:window.location.origin+"/img/icons/favicon-16x16.png",anchor:new google.maps.Point(8,8)}}),r&&(i={label:r});var n=new google.maps.Marker((0,p.Z)((0,p.Z)({},i),{},{position:e,map:this.map}));this.markers.push(n)},removeMarkers:function(){var e,t=(0,H.Z)(this.markers);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.setMap(null)}}catch(i){t.e(i)}finally{t.f()}this.markers=[]},setInfoWindow:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n="";n+=t<1e3?"<b>"+this.$t("Maps.infoWindow.Distance")+": </b>"+new Intl.NumberFormat(this.$i18n.locale,{style:"unit",unit:"meter"}).format(t):"<b>"+this.$t("Maps.infoWindow.Distance")+": </b>"+new Intl.NumberFormat(this.$i18n.locale,{style:"unit",unit:"kilometer"}).format(t/1e3),n+="<br/><b>"+this.$t("Maps.infoWindow.Points")+": </b>"+r;var o=new google.maps.InfoWindow({headerContent:e,headerDisabled:!e,content:"<div>".concat(n,"</div>")});o.open(this.map,this.markers[e||i?this.markers.length-1:0])},drawPolyline:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,i={path:"M 0,-1 0,1",strokeOpacity:1,scale:2},n=new google.maps.Polyline({path:[e,r],strokeOpacity:0,strokeColor:this.strokeColors[t%this.strokeColors.length],icons:[{icon:i,offset:"0",repeat:"10px"}]});n.setMap(this.map),this.polylines.push(n)},removePolylines:function(){var e,t=(0,H.Z)(this.polylines);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.setMap(null)}}catch(i){t.e(i)}finally{t.f()}},startNextRound:function(){var e=this;this.$refs.mapRef.$mapPromise.then((function(){e.map.addListener("click",(function(t){e.removeMarkers(),e.putMarker(t.latLng),e.$emit("setSeletedPos",t.latLng)})),e.centerOnBbox()}))},removeListener:function(){google.maps.event.clearListeners(this.map,"click")},fitBounds:function(){var e,t=new google.maps.LatLngBounds,r=(0,H.Z)(this.markers);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.getVisible()&&t.extend(i.getPosition())}}catch(n){r.e(n)}finally{r.f()}this.map.fitBounds(t)}}},X=Y,Q=(0,P.Z)(X,J,q,!1,null,"3c21c1d4",null),ee=Q.exports,te=function(){var e=this,t=e._self._c;return t("div",{staticClass:"map-areas",attrs:{id:"map"}},[t("div",{staticClass:"map-content"},[e.polygonSelect||e.areaName?t("div",{staticClass:"map-label",attrs:{title:e.areaName}},[e.showFlag?t("FlagIcon",{attrs:{size:"big",rounded:"","iso-name":e.areaRandom||e.areaNameSelect}}):e._e(),t("span",{staticClass:"map-label__country-name",class:{beige:!e.areaRandom,green:!!e.areaRandom,"white--text":!!e.areaRandom,large:!e.showFlag}},[e._v(" "+e._s(e.areaName)+" ")])],1):e._e(),t("GmapMap",{ref:"mapRef",attrs:{id:"mapAreas",center:{lat:37.86926,lng:-122.254811},zoom:1,"map-type-id":"roadmap",options:{fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1,draggableCursor:"crosshair",clickableIcons:!1,styles:e.$vuetify.theme.dark?e.$vuetify.theme.themes.dark.gmap:e.$vuetify.theme.themes.light.gmap}}})],1),e.infoWindowDatas.length>0?t("div",{staticClass:"result-panel"},e._l(e.infoWindowDatas,(function(r){return t("div",{key:r.playerName,staticClass:"result-panel__item",class:{flag:e.showFlag}},[e.showFlag?t("FlagIcon",{attrs:{"iso-name":r.area}}):e._e(),t("b",[e._v(e._s(r.playerName))]),e.showFlag?e._e():t("span",[e._v(e._s(r.area))])],1)})),0):e._e()])},re=[],ie=(r(43304),r(96813)),ne={mixins:[W],components:{FlagIcon:ie.Z},props:{area:{type:String},areasGeoJsonUrl:String,pathKey:{type:String,default:"iso_a2"},showFlag:Boolean},data:function(){return{map:null,polygonSelect:null,areas:{},markers:[],allowSelect:!0,areaRandom:null,randomPos:null,infoWindowDatas:[]}},computed:(0,p.Z)((0,p.Z)({},(0,S.Se)(["areasJson"])),{},{areaName:function(){return this.showFlag&&(this.areaRandom||this.polygonSelect)?this.$countryNameLocale(this.areaRandom||this.areaNameSelect):this.areaRandom||this.areaNameSelect},areaNameSelect:function(){return this.polygonSelect?this.polygonSelect.getFeatureById("feature").getProperty(this.pathKey):void 0}}),mounted:function(){var e=this;return(0,h.Z)((0,m.Z)().mark((function t(){return(0,m.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.loadAreas(e.areasGeoJsonUrl);case 2:return t.next=4,e.$gmapApiPromiseLazy();case 4:e.$refs.mapRef.$mapPromise.then((function(t){e.map=t,e.areasJson.features.forEach((function(t){if(Array.isArray(t.geometry.coordinates)){var r=new google.maps.Data({style:{strokeOpacity:0,fillOpacity:0,strokeWeight:2}});t.id="feature",r.addGeoJson(t),r.setMap(e.map),r.addListener("click",(function(){e.allowSelect&&(e.polygonSelect&&e.polygonSelect.setStyle({strokeOpacity:0,fillOpacity:0}),Object.is(r,e.polygonSelect)?(e.polygonSelect=null,e.$emit("setSeletedPos",null)):(r.setStyle({strokeOpacity:.8,fillOpacity:.3,strokeColor:"#1E3A8A",fillColor:"#1D4ED8"}),e.polygonSelect=r,e.$emit("setSeletedPos",r.getFeatureById("feature").getProperty(e.pathKey))))})),e.areas[t.properties[e.pathKey]]=r}})),e.centerOnBbox()}));case 5:case"end":return t.stop()}}),t)})))()},methods:(0,p.Z)((0,p.Z)({},(0,S.nv)(["loadAreas"])),{},{putMarker:function(e,t,r){var i=t?r||this.area:e;t&&(this.areaRandom=this.area,this.randomPos=new google.maps.Marker({position:e,map:this.map})),this.areas[i]&&(this.areas[i].setStyle({fillOpacity:.3,strokeOpacity:.8,fillColor:t?"#52DA42":"#FF4081",strokeColor:t?"#16A910":"#FF4081"}),this.markers.push(i))},removeMarkers:function(){var e=this;this.markers.forEach((function(t){e.areas[t].setStyle({strokeOpacity:0,fillOpacity:0})})),this.polygonSelect&&this.polygonSelect.setStyle({strokeOpacity:0,fillOpacity:0}),this.randomPos&&(this.randomPos.setMap(null),this.randomPos=null),this.markers=[],this.infoWindowDatas=[]},setInfoWindow:function(e,t,r,i,n){e&&this.infoWindowDatas.push({playerName:e,area:n})},startNextRound:function(){this.polygonSelect&&this.polygonSelect.setStyle({strokeOpacity:0,fillOpacity:0}),this.polygonSelect=null,this.areaRandom=null,this.allowSelect=!0,this.centerOnBbox()},removeListener:function(){this.allowSelect=!1},fitBounds:function(){this.bbox?this.centerOnBbox():this.map.setZoom(2)}})},oe=ne,ae=(0,P.Z)(oe,te,re,!1,null,"30884500",null),se=ae.exports;function le(e,t,r,i){switch(i){case w.se.TIME:return Math.round(ue(e,t)*Math.exp(-r/6e6));default:return ue(e,t)}}function ue(e,t){if(e<50)return 5e3;var r=Math.round(5e3*Math.exp(-e/1e3/t));return r>5e3?5e3:r<0?0:r}var ce=function(){var e=this,t=e._self._c;return t(i.Z,{staticClass:"mt-2 mr-2",attrs:{id:"leaderboard-alert",transition:"slide-x-reverse-transition",width:"300",dark:"",dismissible:"",value:e.value},on:{input:function(t){return e.$emit("input",t)}}},[t("h4",[e._v("Leaderboard")]),t("LeaderboardContent",{attrs:{leaderboard:e.leaderboard}})],1)},de=[],me=(r(68309),function(){var e=this,t=e._self._c;return t("div",e._l(e.leaderboard,(function(r){var i=r.name,n=r.scoreHeader,a=r.guessed,s=r.id;return t("div",{key:s,staticClass:"leaderboard-alert__line"},[t("div",[a?t(o.Z,{attrs:{color:"green"}},[e._v("mdi-check")]):e._e()],1),t("p",[e._v(" "+e._s(i)+" "+e._s(n?": ".concat(n):"")+" ")])])})),0)}),he=[],pe={name:"Leaderboard",props:{leaderboard:Array}},fe=pe,ge=(0,P.Z)(fe,me,he,!1,null,"7a33b83f",null),ye=ge.exports,ve={name:"Leaderboard",props:{leaderboard:Array,value:Boolean},components:{LeaderboardContent:ye}},be=ve,we=(0,P.Z)(be,ce,de,!1,null,"41b5218a",null),Se=we.exports,xe={components:{Leaderboard:Se,DialogSummary:G,DetailsMap:j,Map:ee,MapAreas:se},props:["randomLatLng","randomFeatureProperties","roomName","playerNumber","playerName","isReady","round","score","points","timeLimitation","difficulty","bbox","mode","area","timeAttack","nbRound","countdown","scoreMode","areasGeoJsonUrl","pathKey","mapDetails","leaderboardShown","guessString"],data:function(){return{summaryTexts:[],room:null,selectedPos:null,distance:null,point:null,isGuessButtonClicked:!1,isMakeGuessButtonClicked:!1,isSelected:!1,isNextStreetViewReady:!1,isNextButtonVisible:!1,isSummaryButtonVisible:!1,dialogSummary:!1,activeMap:!1,size:2,isNotepadVisible:!1,pinActive:"true"===localStorage.getItem("pinActive"),printMapFull:!1,countdownStarted:!1,game:{multiplayer:!!this.roomName,date:new Date,rounds:[]},startTime:null}},computed:{isNextButtonEnabled:function(){return 1==this.playerNumber||!this.room||this.isNextStreetViewReady}},watch:{pinActive:function(){localStorage.setItem("pinActive",this.pinActive)},printMapFull:function(e){this.$emit("printMapFull",e)}},mounted:function(){var e=this;return(0,h.Z)((0,m.Z)().mark((function t(){var r;return(0,m.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$gmapApiPromiseLazy();case 2:e.game.timeLimitation=e.timeLimitation,e.game.difficulty=e.difficulty,e.game.mode=e.mode,e.game.timeAttack=e.timeAttack,e.game.playerName=e.playerName,r=0,e.roomName&&(e.room=f.Z.database().ref(e.roomName),e.room.on("value",(function(t){if(t.hasChild("active")){if(r=t.child("size").val(),1===r?e.room.onDisconnect().remove():e.room.onDisconnect().update({size:r-1}),e.timeAttack&&0===e.countdown&&t.child("guess").numChildren()>=1&&t.child("guess").forEach((function(t){return t.child("area").val()===e.area}))||t.child("guess").numChildren()===r){e.game.timeLimitation=e.timeLimitation,e.isNextStreetViewReady=!1,e.$emit("showResult");var i=0,n={};t.child("guess").forEach((function(r){var o;if(e.mode===w.wz.CLASSIC){var a=r.child("latitude").val(),s=r.child("longitude").val();o=new google.maps.LatLng({lat:a,lng:s})}else o=r.child("area").val();var l=t.child("playerName").child(r.key).val(),u=t.child("round"+e.round+"/"+r.key).exportVal(),c=u.points,d=u.distance;n[l]=(0,p.Z)((0,p.Z)({},u),{},{guess:o}),e.$refs.map.drawPolyline(o,i,e.randomLatLng),e.$refs.map.putMarker(o,!1,l&&l.length>0?l[0].toUpperCase():""),e.$refs.map.setInfoWindow(l,d,c,!1,o),i++})),e.$refs.map.fitBounds(),e.game.rounds.push({position:(0,p.Z)((0,p.Z)({},e.randomLatLng.toJSON()),{},{area:e.area}),players:n}),e.$refs.map.putMarker(e.randomLatLng,!0),e.printMapFull=!0,e.room.child("guess").remove(),e.round>=e.nbRound?(t.child("finalPoints").forEach((function(r){var i=t.child("playerName").child(r.key).val(),n=t.child("finalScore").child(r.key).val(),o=r.val();e.summaryTexts.push({playerName:i,finalScore:n,finalPoints:o})})),e.summaryTexts.sort((function(e,t){return parseInt(t.finalPoints)-parseInt(e.finalPoints)})),e.isSummaryButtonVisible=!0):e.isNextButtonVisible=!0}t.child("streetView").numChildren()==e.round+1&&(e.isNextStreetViewReady=!0),!e.countdownStarted&&!e.printMapFull&&e.countdown>0&&t.child("guess").numChildren()>=1&&(e.$parent.initTimer(e.countdown,!0),e.countdownStarted=!0)}})));case 9:case"end":return t.stop()}}),t)})))()},methods:{setSeletedPos:function(e){this.selectedPos=e},showMap:function(){this.isMakeGuessButtonClicked=!0},hideMap:function(){this.isMakeGuessButtonClicked=!1},showNotepad:function(){var e=this;this.isNotepadVisible=!this.isNotepadVisible,this.isNotepadVisible&&setTimeout((function(){e.$refs.refNotepad.focus()}))},selectLocation:function(){this.calculateDistance(),this.room?this.room.child("guess/player"+this.playerNumber).set((0,b.nV)(this.selectedPos,this.mode)):(this.$refs.map.putMarker(this.randomLatLng,!0),this.$refs.map.drawPolyline(this.selectedPos,1,this.randomLatLng),this.$refs.map.setInfoWindow(null,this.distance,this.point,!1,this.setSeletedPos),this.printMapFull=!0,this.$refs.map.fitBounds(),this.round>=this.nbRound?this.isSummaryButtonVisible=!0:this.isNextButtonVisible=!0,this.$emit("showResult")),this.$refs.map.removeListener(),this.isGuessButtonClicked=!0,this.isSelected=!0,this.isNextStreetViewReady=!1},selectRandomLocation:function(e){null===this.selectedPos&&(this.selectedPos=e,this.$refs.map.removeMarkers(),this.$refs.map.putMarker(this.selectedPos)),this.selectLocation()},resetLocation:function(){this.$emit("resetLocation")},calculateDistance:function(){var e=new Date-this.startTime;[w.wz.COUNTRY,w.wz.CUSTOM_AREA].includes(this.mode)?(this.point=+(this.area===this.selectedPos),this.distance=null):(this.distance=Math.floor(google.maps.geometry.spherical.computeDistanceBetween(this.randomLatLng,this.selectedPos)),this.point=le(this.distance,this.difficulty,e,this.scoreMode)),this.room?this.room.child("round"+this.round+"/player"+this.playerNumber).set((0,p.Z)((0,p.Z)({},(0,b.nV)(this.selectedPos,this.mode)),{},{distance:this.distance,points:this.point,timePassed:e})):this.game.rounds.push({guess:this.selectedPos,area:this.area,position:this.randomLatLng,distance:this.distance,points:this.point,timePassed:e}),this.$emit("calculateDistance",this.distance,this.point)},startNextRound:function(){this.$refs.map.startNextRound(),this.startTime=new Date},goToNextRound:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(this.dialogSummary=!1,this.isSummaryButtonVisible=!1),this.selectedPos=null,this.isGuessButtonClicked=!1,this.isSelected=!1,this.isNextButtonVisible=!1,this.countdownStarted=!1,this.isNotepadVisible=!1,this.$viewport.width<450&&this.hideMap(),this.printMapFull=!1,this.$refs.map.removeMarkers(),this.$refs.map.removePolylines(),this.$refs.map.centerOnBbox(),this.$emit("goToNextRound",e)},finishGame:function(){this.dialogSummary=!1,this.room&&this.room.child("isGameDone/player"+this.playerNumber).set(!0),this.$emit("finishGame")}}},ke=xe,Pe=(0,P.Z)(ke,L,C,!1,null,"f0261f86",null),Me=Pe.exports,_e=r(62003),Le=r(8233),Ce=function(){var e=this,t=e._self._c;return t(E.Z,{attrs:{value:e.dialogMessage,"max-width":"600",persistent:"",fullscreen:e.$viewport.width<450}},[t(N.Z,{attrs:{color:"#061422"}},[t(R.EB,[t("span",{staticClass:"dialog-message__title",attrs:{id:"card-title"}},[e._v(e._s(e.dialogTitle))]),t(Le.Z),e.dismissible?t(n.Z,{attrs:{icon:""},on:{click:function(t){return e.$emit("close")}}},[t(o.Z,[e._v("mdi-close")])],1):e._e()],1),t(R.ZB,[t(_e.Z,[e._t("default",(function(){return[t("span",[e._v(e._s(e.dialogText))])]}))],2)],1)],1)],1)},Ne=[],Re={props:["dialogMessage","dialogTitle","dialogText","dismissible"]},Ee=Re,Ze=(0,P.Z)(Ee,Ce,Ne,!1,null,"41bf8db0",null),Te=Ze.exports,Ae=r(70077),$e=r(27790),Ve=(r(39714),r(21703),r(86612)),Fe=r(28906),Ge=r(80883),Oe=r(53043),De=r.n(Oe),Be=function(){function e(t,r,i,n){(0,Ae.Z)(this,e),this.settingsPanorama=t,this.settingsGame=r,this.placeGeoJson=i,this.roundsPredefined=n,this.service=new google.maps.StreetViewService,this.alreadyVisited=[]}return(0,$e.Z)(e,[{key:"getStreetView",value:function(){var e=(0,h.Z)((0,m.Z)().mark((function e(t){var r,i,n,o,a,s,l=this,u=arguments;return(0,m.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=u.length>1&&void 0!==u[1]?u[1]:0,this.roundsPredefined)i=50,a=this.roundsPredefined[t-1],n=new google.maps.LatLng(a[0],a[1]);else{do{s=this.getRandomLatLng()}while(this.alreadyVisited.includes(s.position.toString()));this.alreadyVisited.push(s.position.toString()),i=s.radius,n=s.position,o=s.properties}return e.abrupt("return",new Promise((function(e){l.service.getPanorama({location:n,preference:"nearest",radius:i,sources:l.settingsPanorama.allPanorama?[google.maps.StreetViewSource.DEFAULT,google.maps.StreetViewSource.OUTDOOR,google.maps.StreetViewSource.GOOGLE]:[google.maps.StreetViewSource.GOOGLE]},function(){var i=(0,h.Z)((0,m.Z)().mark((function i(n,a){return(0,m.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(a===google.maps.StreetViewStatus.OK&&n&&n.location&&l._checkStreetView(n)){i.next=8;break}return i.t0=e,i.next=4,l.getStreetView(t);case 4:i.t1=i.sent,(0,i.t0)(i.t1),i.next=13;break;case 8:return i.t2=e,i.next=11,l._getResponseStreetViewService(t,n,r,o);case 11:i.t3=i.sent,(0,i.t2)(i.t3);case 13:case"end":return i.stop()}}),i)})));return function(e,t){return i.apply(this,arguments)}}())})));case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_getResponseStreetViewService",value:function(){var e=(0,h.Z)((0,m.Z)().mark((function e(t,r,i,n){var o,a,s;return(0,m.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=!1,null!=this.placeGeoJson&&(o=(0,b.Rw)(Ge.xm([r.location.latLng.lng(),r.location.latLng.lat()]),this.placeGeoJson)),!(!1===o&&i<3)){e.next=6;break}return e.abrupt("return",this.getStreetView(t,i+1));case 6:return!1===o&&(a=!0),e.prev=7,e.next=10,this._getAreaCode(r);case 10:s=e.sent,e.next=16;break;case 13:return e.prev=13,e.t0=e["catch"](7),e.abrupt("return",this.getStreetView(t));case 16:return e.abrupt("return",{panorama:r,roundInfo:n||null,area:s,warning:a});case 17:case"end":return e.stop()}}),e,this,[[7,13]])})));function t(t,r,i,n){return e.apply(this,arguments)}return t}()},{key:"getRandomLatLng",value:function(){if(null!=this.placeGeoJson){var e,t,r=null;if("FeatureCollection"===this.placeGeoJson.type){var i=Math.floor(Math.random()*this.placeGeoJson.features.length),n=this.placeGeoJson.features[i];r=n.properties,"Point"===n.geometry.type?(e=n.geometry.coordinates,t=50):(t=10*(0,b.CX)((0,Ve.Z)(n)),e=De()(n))}else t=10*(0,b.CX)((0,Ve.Z)(this.placeGeoJson)),e=De()(this.placeGeoJson);return{radius:t,position:new google.maps.LatLng(e[1],e[0]),properties:r}}var o=57.2958*Math.acos(1.99*Math.random()-.995)-90,a=360*Math.random()-180;return{radius:1e5,position:new google.maps.LatLng(o,a),properties:null}}},{key:"_checkStreetView",value:function(e){return!(this.settingsPanorama.optimiseStreetView&&(!e.imageDate||e.links.length<2||Array.isArray(e.g)&&0!==e.g.length))}},{key:"_getAreaCode",value:function(){var e=(0,h.Z)((0,m.Z)().mark((function e(t){var r,i;return(0,m.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(![w.wz.COUNTRY,w.wz.CUSTOM_AREA].includes(this.settingsGame.mode)){e.next=12;break}if(!(this.settingsGame.mode===w.wz.COUNTRY||this.settingsGame.areaParams&&this.settingsGame.areaParams.data.type===w.Ho.NOMINATIM)){e.next=5;break}return e.abrupt("return",(0,b.Xp)(t.location.latLng,this.settingsGame.areaParams&&this.settingsGame.areaParams.data));case 5:if(r=this.settingsGame.areasJson.features.find((function(e){return(0,Fe.Z)([t.location.latLng.lng(),t.location.latLng.lat()],e)})),r){e.next=10;break}throw new Error("Area not found");case 10:return i=this.settingsGame.areaParams?this.settingsGame.areaParams.data.pathKey:"iso_a2",e.abrupt("return",r.properties[i]);case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),Ie=Be,ze={data:function(){return{canExit:!1}},methods:{beforeUnload:function(e){e.returnValue=this.$t("StreetView.confirmExit")}},created:function(){window.addEventListener("beforeunload",this.beforeUnload)},beforeRouteLeave:function(e,t,r){if(this.canExit)r();else{var i=window.confirm(this.$t("StreetView.confirmExit"));i?r():r(!1)}},beforeDestroy:function(){window.removeEventListener("beforeunload",this.beforeUnload)}},Ue={components:{Leaderboard:Se,HeaderGame:_,Maps:Me,DialogMessage:Te,LeaderboardContent:ye},mixins:[ze],props:{roomName:{default:null,type:String},allPanorama:{default:!1,type:Boolean},optimiseStreetView:{default:!0,type:Boolean},playerNumber:{default:null,type:Number},playerName:{default:null,type:String},placeGeoJson:{default:null,type:Object},multiplayer:{default:!1,type:Boolean},time:{default:0,type:Number},difficulty:{default:2e3,type:Number},bboxObj:{default:null,type:Array},roundsPredefined:{default:null,type:Array},modeSelected:{default:w.wz.CLASSIC,type:String},panControl:{default:!0,type:Boolean},zoomControl:{default:!0,type:Boolean},moveControl:{default:!0,type:Boolean},timeAttackSelected:{default:!1,type:Boolean},countdown:{default:0,type:Number},scoreMode:{default:w.se.NORMAL,type:String},areaParams:{type:Object},mapDetails:{type:Object,required:!1,default:void 0},nbRoundSelected:{type:Number,required:!1,default:5},guessedLeaderboard:{default:!0,type:Boolean},scoreLeaderboard:{default:!0,type:Boolean}},data:function(){return{area:null,randomLatLng:null,randomFeatureProperties:null,score:0,scoreHeader:0,points:0,pointsHeader:0,round:1,timeLimitation:this.time,mode:this.modeSelected,timeAttack:this.timeAttackSelected,nbRound:this.timeAttackSelected?10:this.nbRoundSelected,remainingTime:0,endTime:null,hasTimerStarted:!1,hasLocationSelected:!1,overlay:!1,room:null,isReady:!1,dialogMessage:this.multiplayer,dialogTitle:this.$t("StreetView.waitForOtherPlayers"),dialogText:"",isVisibleDialog:!1,panorama:null,difficultyData:this.difficulty,bbox:this.bboxObj,isVisibleCountdownAlert:!1,timeCountdown:0,streetViewService:null,leaderboard:[],leaderboardShown:!this.$vuetify.breakpoint.mobile&&this.roomName&&(this.guessedLeaderboard||this.scoreLeaderboard),printMapFull:!1}},computed:(0,p.Z)((0,p.Z)((0,p.Z)({},(0,S.Se)(["areasJson"])),(0,S.rn)("settingsStore",["players"])),{},{countdownPercentage:function(){return 100*this.remainingTime/this.timeCountdown}}),mounted:function(){var e=this;return(0,h.Z)((0,m.Z)().mark((function t(){return(0,m.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.areaParams&&e.areaParams.data.urlArea||e.mode===w.wz.COUNTRY)){t.next=3;break}return t.next=3,e.loadAreas(e.areaParams&&e.areaParams.data.urlArea);case 3:return t.next=5,e.$gmapApiPromiseLazy();case 5:if(e.panorama=new google.maps.StreetViewPanorama(e.$refs.streetView),e.streetViewService||(e.streetViewService=new Ie({allPanorama:e.allPanorama,optimiseStreetView:e.optimiseStreetView},{mode:e.mode,areaParams:e.areaParams,areasJson:e.areasJson},e.placeGeoJson,e.roundsPredefined)),e.multiplayer){t.next=15;break}return t.next=10,e.loadStreetView();case 10:e.$refs.mapContainer.startNextRound(),0!=e.timeLimitation&&(e.hasTimerStarted||(e.initTimer(e.timeLimitation),e.hasTimerStarted=!0)),e.isReady=!0,t.next=22;break;case 15:if(e.roomName||e.exitGame(),e.room=f.Z.database().ref(e.roomName),1!==e.playerNumber){t.next=20;break}return t.next=20,e.loadStreetView();case 20:e.room.child("active").set(!0),e.room.on("value",(function(t){if(t.hasChild("active")){if(e.scoreLeaderboard?e.leaderboard=Object.entries(t.val().playerName).map((function(r){var i,n,o,a,s;return{scoreHeader:(null===(i=e.leaderboard.find((function(e){return e.id===r[0]})))||void 0===i?void 0:i.scoreHeader)||0,score:(null===(n=t.val())||void 0===n||null===(o=n.finalPoints)||void 0===o?void 0:o[r[0]])||0,name:r[1],id:r[0],guessed:!(null===(a=t.val())||void 0===a||null===(s=a.guess)||void 0===s||!s[r[0]])}})):e.guessedLeaderboard&&(e.leaderboard=Object.entries(t.val().playerName).map((function(e){var r,i;return{name:e[1],guessed:!(null===(r=t.val())||void 0===r||null===(i=r.guess)||void 0===i||!i[e[0]]),id:e[0]}}))),!t.child("round"+e.round).hasChild("player"+e.playerNumber)&&(e.room.child("round"+e.round).child("player"+e.playerNumber).set(0),1!=e.playerNumber)){var r=t.child("streetView/round"+e.round+"/latitude").val(),i=t.child("streetView/round"+e.round+"/longitude").val();e.area=t.child("streetView/round"+e.round+"/area").val(),e.isVisibleDialog=t.child("streetView/round"+e.round+"/warning").val(),e.randomFeatureProperties=t.child("streetView/round"+e.round+"/roundInfo").val(),e.randomLatLng=new google.maps.LatLng(r,i),e.resetLocation()}t.child("round"+e.round).numChildren()!==t.child("size").val()||e.isReady||(e.dialogMessage=!1,e.dialogText="",e.isReady=!0,e.$refs.mapContainer.startNextRound(),e.timeLimitation=t.child("timeLimitation").val(),0!=e.timeLimitation&&(e.hasTimerStarted||(e.initTimer(e.timeLimitation),e.hasTimerStarted=!0))),t.child("isGameDone").numChildren()==t.child("size").val()&&(e.room.child("active").remove(),e.room.off(),e.room.remove())}else e.exitGame()}));case 22:e.$refs.header.startTimer();case 23:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){document.querySelector(".widget-scene")&&(document.querySelector(".widget-scene").removeEventListener("keydown",this.onUserEventPanoramaKey),document.querySelector(".widget-scene").removeEventListener("mousedown",this.onUserEventPanoramaMouse)),window.removeEventListener("beforeunload",this.beforeUnload),this.room&&(this.room.child("active").remove(),this.room.off())},methods:(0,p.Z)((0,p.Z)({},(0,S.nv)(["loadAreas"])),{},{loadStreetView:function(){var e=this;return(0,h.Z)((0,m.Z)().mark((function t(){var r,i,n,o,a;return(0,m.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.streetViewService.getStreetView(e.round);case 2:r=t.sent,i=r.panorama,n=r.roundInfo,o=r.warning,a=r.area,e.randomLatLng=i.location.latLng,e.randomFeatureProperties=n,e.area=a,e.setPosition(i),e.multiplayer&&e.room.child("streetView/round"+e.round).set((0,p.Z)((0,p.Z)({latitude:e.randomLatLng.lat(),longitude:e.randomLatLng.lng(),roundInfo:n},a&&{area:a}),{},{warning:o}));case 12:case"end":return t.stop()}}),t)})))()},resetLocation:function(){var e=new google.maps.StreetViewService;e.getPanorama({location:this.randomLatLng,preference:"nearest",radius:50,sources:this.allPanorama?[google.maps.StreetViewSource.DEFAULT,google.maps.StreetViewSource.OUTDOOR,google.maps.StreetViewSource.GOOGLE]:[google.maps.StreetViewSource.GOOGLE]},this.setPosition)},setPosition:function(e){var t=this;this.panorama.setOptions({addressControl:!1,fullscreenControl:!1,motionTracking:!1,motionTrackingControl:!1,showRoadLabels:!1,panControl:this.panControl,zoomControl:this.zoomControl,scrollwheel:this.zoomControl,disableDoubleClickZoom:!this.zoomControl,linksControl:this.moveControl,clickToGo:this.moveControl}),document.querySelector('#street-view a[href^="https://maps"]')&&document.querySelector('#street-view a[href^="https://maps"]').remove(),setTimeout((function(){document.querySelector(".widget-scene")&&(document.querySelector(".widget-scene").addEventListener("keydown",t.onUserEventPanoramaKey),document.querySelector(".widget-scene").addEventListener("mousedown",t.onUserEventPanoramaMouse),document.querySelector(".widget-scene").addEventListener("touchstart",t.onUserEventPanoramaMouse),document.querySelector(".widget-scene").addEventListener("pointerdown",t.onUserEventPanoramaMouse))}),50),e&&e.location&&this.panorama.setPano(e.location.pano),this.panorama.setPov({heading:270,pitch:0}),this.panorama.setZoom(0)},initTimer:function(e,t){var r=new Date;r.setSeconds(r.getSeconds()+e),t&&(this.timeCountdown=e,this.isVisibleCountdownAlert=!0),this.hasTimerStarted?this.endTime=this.endTime>r?r:this.endTime:(this.endTime=r,this.startTimer())},startTimer:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.round;t===this.round&&(this.remainingTime=Math.max(0,Math.round((this.endTime-Date.now())/1e3)),this.remainingTime>0?setTimeout((function(){e.startTimer(t)}),1e3):(this.timerInProgress=!1,this.hasLocationSelected||([w.wz.COUNTRY,w.wz.CUSTOM_AREA].includes(this.mode)?this.$refs.mapContainer.selectRandomLocation((0,b.j8)(this.areasJson,this.areaParams?this.areaParams.data.pathKey:"iso_a2")):this.$refs.mapContainer.selectRandomLocation(this.streetViewService.getRandomLatLng().position))))},updateScore:function(e,t){this.hasLocationSelected=!0,this.multiplayer||(this.remainingTime=0),this.score+=e,this.points+=t,this.multiplayer&&(this.room.child("finalScore/player"+this.playerNumber).set(this.score),this.room.child("finalPoints/player"+this.playerNumber).set(this.points),this.dialogTitle=this.$t("StreetView.waitForOtherPlayers"),this.dialogMessage=!0)},showResult:function(){this.scoreHeader=this.score,this.pointsHeader=this.points,this.remainingTime=0,this.dialogMessage=!1,this.isVisibleCountdownAlert=!1,this.overlay=!0,this.$refs.header.stopTimer();for(var e=0,t=Object.entries(this.leaderboard);e<t.length;e++){var r=t[e];r[1].scoreHeader=r[1].score}},goToNextRound:function(){var e=arguments,t=this;return(0,h.Z)((0,m.Z)().mark((function r(){var i;return(0,m.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(i=e.length>0&&void 0!==e[0]&&e[0],i&&(t.round=0,t.scoreHeader=0,t.pointsHeader=0,t.score=0,t.points=0),t.isReady=!1,t.randomLatLng=null,t.area=null,t.overlay=!1,t.hasTimerStarted=!1,t.hasLocationSelected=!1,t.isVisibleDialog=!1,t.randomFeatureProperties=null,t.multiplayer&&(t.dialogMessage=!0,t.isReady=!1),t.round+=1,1!=t.playerNumber&&t.multiplayer){r.next=18;break}return r.next=15,t.loadStreetView();case 15:t.multiplayer||0==t.timeLimitation||t.initTimer(t.timeLimitation),r.next=19;break;case 18:t.room.child("trigger/player"+t.playerNumber).set(t.round);case 19:t.$refs.mapContainer.startNextRound(),t.isReady=!t.multiplayer;case 21:case"end":return r.stop()}}),r)})))()},exitGame:function(){this.dialogTitle=this.$t("StreetView.redirectToHomePage"),this.dialogText=this.$t("StreetView.exitGame"),this.dialogMessage=!0,this.canExit=!0,this.room?(this.room.off(),this.room.remove(),this.$router.push("/history")):this.$router.push("/")},finishGame:function(){this.canExit=!0,this.multiplayer?(this.dialogTitle=this.$t("StreetView.waitForOtherPlayersToFinish"),this.dialogText="",this.dialogMessage=!0):this.$router.push("/history")},onUserEventPanoramaKey:function(e){(!this.moveControl&&[38,40,87,83,90].includes(e.keyCode)||!this.zoomControl&&[107,109,187,189].includes(e.keyCode)||!this.panControl&&[37,39,65,68,100,102].includes(e.keyCode))&&e.stopPropagation()},onUserEventPanoramaMouse:function(e){this.panControl||e.stopPropagation()}})},je=Ue,Je=(0,P.Z)(je,c,d,!1,null,"89aed002",null),qe=Je.exports},69720:function(e,t,r){var i=r(82109),n=r(44699).entries;i({target:"Object",stat:!0},{entries:function(e){return n(e)}})},83753:function(e,t,r){"use strict";var i=r(82109),n=r(46916);i({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return n(URL.prototype.toString,this)}})},53043:function(e,t,r){"use strict";const i=r(45794).Z,n=r(16295),o=r(58580).Z;function a(e){if(!e||!e.type||"Feature"!==e.type||-1===["Polygon","MultiPolygon"].indexOf(e.geometry.type))throw new Error("param polygon must be a Feature<(Polygon|MultiPolygon)>");let t;const r=i(e);do{t=n.randomPosition(r)}while(!o(t,e));return t}e.exports=a},45794:function(e,t,r){"use strict";var i=r(92196);function n(e){var t=[1/0,1/0,-1/0,-1/0];return i.coordEach(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}n["default"]=n,t.Z=n},58580:function(e,t,r){"use strict";var i=r(53853);function n(e,t,r){if(void 0===r&&(r={}),!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var n=i.getCoord(e),s=i.getGeom(t),l=s.type,u=t.bbox,c=s.coordinates;if(u&&!1===a(n,u))return!1;"Polygon"===l&&(c=[c]);for(var d=!1,m=0;m<c.length&&!d;m++)if(o(n,c[m][0],r.ignoreBoundary)){var h=!1,p=1;while(p<c[m].length&&!h)o(n,c[m][p],!r.ignoreBoundary)&&(h=!0),p++;h||(d=!0)}return d}function o(e,t,r){var i=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var n=0,o=t.length-1;n<t.length;o=n++){var a=t[n][0],s=t[n][1],l=t[o][0],u=t[o][1],c=e[1]*(a-l)+s*(l-e[0])+u*(e[0]-a)===0&&(a-e[0])*(l-e[0])<=0&&(s-e[1])*(u-e[1])<=0;if(c)return!r;var d=s>e[1]!==u>e[1]&&e[0]<(l-a)*(e[1]-s)/(u-s)+a;d&&(i=!i)}return i}function a(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}t.Z=n},94126:function(e,t){"use strict";function r(e,t,r){void 0===r&&(r={});var i={type:"Feature"};return(0===r.id||r.id)&&(i.id=r.id),r.bbox&&(i.bbox=r.bbox),i.properties=t||{},i.geometry=e,i}function i(e,t,r){switch(void 0===r&&(r={}),e){case"Point":return n(t).geometry;case"LineString":return l(t).geometry;case"Polygon":return a(t).geometry;case"MultiPoint":return m(t).geometry;case"MultiLineString":return d(t).geometry;case"MultiPolygon":return h(t).geometry;default:throw new Error(e+" is invalid")}}function n(e,t,i){if(void 0===i&&(i={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!P(e[0])||!P(e[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:e};return r(n,t,i)}function o(e,t,r){return void 0===r&&(r={}),c(e.map((function(e){return n(e,t)})),r)}function a(e,t,i){void 0===i&&(i={});for(var n=0,o=e;n<o.length;n++){var a=o[n];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}var l={type:"Polygon",coordinates:e};return r(l,t,i)}function s(e,t,r){return void 0===r&&(r={}),c(e.map((function(e){return a(e,t)})),r)}function l(e,t,i){if(void 0===i&&(i={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:e};return r(n,t,i)}function u(e,t,r){return void 0===r&&(r={}),c(e.map((function(e){return l(e,t)})),r)}function c(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function d(e,t,i){void 0===i&&(i={});var n={type:"MultiLineString",coordinates:e};return r(n,t,i)}function m(e,t,i){void 0===i&&(i={});var n={type:"MultiPoint",coordinates:e};return r(n,t,i)}function h(e,t,i){void 0===i&&(i={});var n={type:"MultiPolygon",coordinates:e};return r(n,t,i)}function p(e,t,i){void 0===i&&(i={});var n={type:"GeometryCollection",geometries:e};return r(n,t,i)}function f(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r}function g(e,r){void 0===r&&(r="kilometers");var i=t.factors[r];if(!i)throw new Error(r+" units is invalid");return e*i}function y(e,r){void 0===r&&(r="kilometers");var i=t.factors[r];if(!i)throw new Error(r+" units is invalid");return e/i}function v(e,t){return w(y(e,t))}function b(e){var t=e%360;return t<0&&(t+=360),t}function w(e){var t=e%(2*Math.PI);return 180*t/Math.PI}function S(e){var t=e%360;return t*Math.PI/180}function x(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return g(y(e,t),r)}function k(e,r,i){if(void 0===r&&(r="meters"),void 0===i&&(i="kilometers"),!(e>=0))throw new Error("area must be a positive number");var n=t.areaFactors[r];if(!n)throw new Error("invalid original units");var o=t.areaFactors[i];if(!o)throw new Error("invalid final units");return e/n*o}function P(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function M(e){return!!e&&e.constructor===Object}function _(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!P(e))throw new Error("bbox must only contain numbers")}))}function L(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:1.0936*t.earthRadius},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1.0936133},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=r,t.geometry=i,t.point=n,t.points=o,t.polygon=a,t.polygons=s,t.lineString=l,t.lineStrings=u,t.featureCollection=c,t.multiLineString=d,t.multiPoint=m,t.multiPolygon=h,t.geometryCollection=p,t.round=f,t.radiansToLength=g,t.lengthToRadians=y,t.lengthToDegrees=v,t.bearingToAzimuth=b,t.radiansToDegrees=w,t.degreesToRadians=S,t.convertLength=x,t.convertArea=k,t.isNumber=P,t.isObject=M,t.validateBBox=_,t.validateId=L},53853:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(94126);function n(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function o(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function a(e){if(e.length>1&&i.isNumber(e[0])&&i.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return a(e[0]);throw new Error("coordinates must only contain numbers")}function s(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)}function l(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)}function u(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var i=0,n=e.features;i<n.length;i++){var o=n[i];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!o.geometry||o.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+o.geometry.type)}}function c(e){return"Feature"===e.type?e.geometry:e}function d(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type}t.getCoord=n,t.getCoords=o,t.containsNumber=a,t.geojsonType=s,t.featureOf=l,t.collectionOf=u,t.getGeom=c,t.getType=d},92196:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(94126);function n(e,t,r){if(null!==e)for(var i,o,a,s,l,u,c,d,m=0,h=0,p=e.type,f="FeatureCollection"===p,g="Feature"===p,y=f?e.features.length:1,v=0;v<y;v++){c=f?e.features[v].geometry:g?e.geometry:e,d=!!c&&"GeometryCollection"===c.type,l=d?c.geometries.length:1;for(var b=0;b<l;b++){var w=0,S=0;if(s=d?c.geometries[b]:c,null!==s){u=s.coordinates;var x=s.type;switch(m=!r||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===t(u,h,v,w,S))return!1;h++,w++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++){if(!1===t(u[i],h,v,w,S))return!1;h++,"MultiPoint"===x&&w++}"LineString"===x&&w++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(o=0;o<u[i].length-m;o++){if(!1===t(u[i][o],h,v,w,S))return!1;h++}"MultiLineString"===x&&w++,"Polygon"===x&&S++}"Polygon"===x&&w++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for(S=0,o=0;o<u[i].length;o++){for(a=0;a<u[i][o].length-m;a++){if(!1===t(u[i][o][a],h,v,w,S))return!1;h++}S++}w++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===n(s.geometries[i],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(e,t,r,i){var o=r;return n(e,(function(e,i,n,a,s){o=0===i&&void 0===r?e:t(o,e,i,n,a,s)}),i),o}function a(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length;r++)if(!1===t(e.features[r].properties,r))break;break;case"Feature":t(e.properties,0);break}}function s(e,t,r){var i=r;return a(e,(function(e,n){i=0===n&&void 0===r?e:t(i,e,n)})),i}function l(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length;r++)if(!1===t(e.features[r],r))break}function u(e,t,r){var i=r;return l(e,(function(e,n){i=0===n&&void 0===r?e:t(i,e,n)})),i}function c(e){var t=[];return n(e,(function(e){t.push(e)})),t}function d(e,t){var r,i,n,o,a,s,l,u,c,d,m=0,h="FeatureCollection"===e.type,p="Feature"===e.type,f=h?e.features.length:1;for(r=0;r<f;r++){for(s=h?e.features[r].geometry:p?e.geometry:e,u=h?e.features[r].properties:p?e.properties:{},c=h?e.features[r].bbox:p?e.bbox:void 0,d=h?e.features[r].id:p?e.id:void 0,l=!!s&&"GeometryCollection"===s.type,a=l?s.geometries.length:1,n=0;n<a;n++)if(o=l?s.geometries[n]:s,null!==o)switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,m,u,c,d))return!1;break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===t(o.geometries[i],m,u,c,d))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,m,u,c,d))return!1;m++}}function m(e,t,r){var i=r;return d(e,(function(e,n,o,a,s){i=0===n&&void 0===r?e:t(i,e,n,o,a,s)})),i}function h(e,t){d(e,(function(e,r,n,o,a){var s,l=null===e?null:e.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==t(i.feature(e,n,{bbox:o,id:a}),r,0)&&void 0}switch(l){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon";break}for(var u=0;u<e.coordinates.length;u++){var c=e.coordinates[u],d={type:s,coordinates:c};if(!1===t(i.feature(d,n),r,u))return!1}}))}function p(e,t,r){var i=r;return h(e,(function(e,n,o){i=0===n&&0===o&&void 0===r?e:t(i,e,n,o)})),i}function f(e,t){h(e,(function(e,r,o){var a=0;if(e.geometry){var s=e.geometry.type;if("Point"!==s&&"MultiPoint"!==s){var l,u=0,c=0,d=0;return!1!==n(e,(function(n,s,m,h,p){if(void 0===l||r>u||h>c||p>d)return l=n,u=r,c=h,d=p,void(a=0);var f=i.lineString([l,n],e.properties);if(!1===t(f,r,o,p,a))return!1;a++,l=n}))&&void 0}}}))}function g(e,t,r){var i=r,n=!1;return f(e,(function(e,o,a,s,l){i=!1===n&&void 0===r?e:t(i,e,o,a,s,l),n=!0})),i}function y(e,t){if(!e)throw new Error("geojson is required");h(e,(function(e,r,n){if(null!==e.geometry){var o=e.geometry.type,a=e.geometry.coordinates;switch(o){case"LineString":if(!1===t(e,r,n,0,0))return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(!1===t(i.lineString(a[s],e.properties),r,n,s))return!1;break}}}))}function v(e,t,r){var i=r;return y(e,(function(e,n,o,a){i=0===n&&void 0===r?e:t(i,e,n,o,a)})),i}function b(e,t){if(t=t||{},!i.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,o=t.multiFeatureIndex||0,a=t.geometryIndex||0,s=t.segmentIndex||0,l=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),l=l||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":l=l||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=u.length+s-1),i.lineString([u[s],u[s+1]],l,t);case"Polygon":return a<0&&(a=u.length+a),s<0&&(s=u[a].length+s-1),i.lineString([u[a][s],u[a][s+1]],l,t);case"MultiLineString":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s-1),i.lineString([u[o][s],u[o][s+1]],l,t);case"MultiPolygon":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),s<0&&(s=u[o][a].length-s-1),i.lineString([u[o][a][s],u[o][a][s+1]],l,t)}throw new Error("geojson is invalid")}function w(e,t){if(t=t||{},!i.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,o=t.multiFeatureIndex||0,a=t.geometryIndex||0,s=t.coordIndex||0,l=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),l=l||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":l=l||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":return i.point(u,l,t);case"MultiPoint":return o<0&&(o=u.length+o),i.point(u[o],l,t);case"LineString":return s<0&&(s=u.length+s),i.point(u[s],l,t);case"Polygon":return a<0&&(a=u.length+a),s<0&&(s=u[a].length+s),i.point(u[a][s],l,t);case"MultiLineString":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),i.point(u[o][s],l,t);case"MultiPolygon":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),s<0&&(s=u[o][a].length-s),i.point(u[o][a][s],l,t)}throw new Error("geojson is invalid")}t.coordAll=c,t.coordEach=n,t.coordReduce=o,t.featureEach=l,t.featureReduce=u,t.findPoint=w,t.findSegment=b,t.flattenEach=h,t.flattenReduce=p,t.geomEach=d,t.geomReduce=m,t.lineEach=y,t.lineReduce=v,t.propEach=a,t.propReduce=s,t.segmentEach=f,t.segmentReduce=g}}]);
//# sourceMappingURL=133-legacy.ff56db86.js.map